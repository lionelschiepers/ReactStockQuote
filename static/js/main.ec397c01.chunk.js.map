{"version":3,"sources":["logo.svg","Components/ExchangeRates.js","Components/YahooFinanceLoader.js","Components/Portfolio.js","Components/YahooFinance.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","Cache","GetRate","from","to","a","Rates","axios","get","then","res","node","doc","DOMParser","parseFromString","data","nsResolver","createNSResolver","documentElement","nodes","evaluate","XPathResult","ANY_TYPE","result","iterateNext","currency","getAttribute","rate","push","parseFloat","Error","fromRate","find","o","toRate","anyCorsHttp","create","baseURL","getUrl","quotes","fields","_","isArray","url","yahooFinanceUrl","join","YahooFinanceFields","YahooFinanceLoader","Symbol","symbols","now","Date","i","length","symbol","cacheItem","localStorage","getItem","JSON","parse","splice","removeItem","chunks","chunk","json","quoteResponse","forEach","setItem","stringify","SecurityPostion","NumberOfShares","MarketCost","Transactions","PastGain","RateToEUR","this","Security","Price","MarketPrice","price","regularMarketPrice","previousPrice","regularMarketPreviousClose","CurrencyHelper","positions","position","Ticker","indexOf","Currency","endsWith","Portfolio","parsedCsv","parser","columns","Shares","Math","abs","Commission","item","Name","Type","toLowerCase","console","log","lastTransaction","last","x","min","pop","updateCurrency","tickers","map","loader","Load","yahooData","y","MarketPriceEUR","YahooFinance","props","state","portfolio","sortBy","sortDirection","SortDirection","ASC","_sort","bind","setState","list","orderedList","p","diff","getPriceDiff","DESC","reverse","_internalSort","cellData","dataKey","columnData","columnIndex","rowData","isScrolling","postData","rowIndex","toFixed","height","width","headerHeight","rowHeight","sort","rowCount","rowGetter","index","align","label","disableSort","cellDataGetter","cellRenderer","renderPrice","getGain","Component","App","className","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"uKAAAA,EAAOC,QAAU,IAA0B,kC,mTCGrCC,E,kCAKC,SAAeC,EAAtB,oC,4CAAO,WAAuBC,EAAMC,GAA7B,mBAAAC,EAAA,yDAEgB,MAAfJ,EAAMK,MAFP,gCAIOC,IACDC,IAAI,qGACJC,MAAK,SAAAC,GAUE,IARA,IAOIC,EANAC,GADO,IAAIC,WACEC,gBAAgBJ,EAAIK,KAAM,YAEvCC,EAAaJ,EAAIK,iBAAiBL,EAAIM,iBAEtCC,EAAQP,EAAIQ,SAAS,sEAAuER,EAAIM,gBAAiBF,EAAYK,YAAYC,SAAU,MACnJC,EAAS,GAEyB,OAA/BZ,EAAOQ,EAAMK,gBACpB,CACI,IAAIC,EAAWd,EAAKe,aAAa,YAC7BC,EAAOhB,EAAKe,aAAa,QAE7BH,EAAOK,KAAK,CAAEH,SAASA,EAAUE,KAAKE,WAAWF,KAEhC,QAAbF,GAEAF,EAAOK,KAAK,CAAEH,SAAS,MAAOE,KAAK,IAASE,WAAWF,KAK/DJ,EAAOK,KAAK,CAAEH,SAAS,MAAOE,KAAK,IAEnC1B,EAAMK,MAAQiB,KAhC3B,UAoCgB,MAAftB,EAAMK,MApCP,sBAqCO,IAAIwB,MAAM,yCArCjB,UAwCa,OADZC,EAAW9B,EAAMK,MAAM0B,MAAK,SAAAC,GAAC,OAAGA,EAAER,WAAatB,MAvChD,sBAyCO,IAAI2B,MAAO,iCAAmC3B,GAzCrD,UA2CW,OADV+B,EAASjC,EAAMK,MAAM0B,MAAK,SAAAC,GAAC,OAAGA,EAAER,WAAarB,MA1C9C,uBA4CO,IAAI0B,MAAO,iCAAmCI,GA5CrD,eA+CCP,EAAQ,EAAEI,EAASJ,KAAQO,EAAOP,KA/CnC,kBAgDIA,GAhDJ,6C,sBCJP,IAAMQ,EAAc5B,IAAM6B,OACtB,CAAEC,QAAQ,wCAKZ,SAASC,EAAOC,EAAQC,GAEjBC,IAAEC,QAAQH,KACbA,EAAS,CAACA,IAEV,IAAII,EAAMC,6DAAgCH,IAAEI,KAAKN,EAAQ,KACzD,OAAc,MAAVC,EACKG,EAEFA,EAAM,WAAaF,IAAEI,KAAKL,EAAQ,KAGxC,IAAMM,EAuDoB,6BAvDpBA,EAwDY,qBAwBZC,GAZTC,OAYJ,sIAEaC,EAAST,GAFtB,qFAQI,IAJIU,EAAMC,KAAKD,MAEX3B,EAAS,GAEL6B,EAAIH,EAAQI,OAAS,EAAGD,GAAK,EAAGA,IAElCE,EAASL,EAAQG,GAEJ,OADbG,EAAYC,aAAaC,QAAQH,MAGnCC,EAAYG,KAAKC,MAAMJ,GAClBL,EAAMK,EAAUJ,KAAQ,KAE3B5B,EAAOK,KAAK2B,GACZN,EAAQW,OAAOR,EAAG,IAIlBI,aAAaK,WAAWP,IAK1BQ,EAASrB,IAAEsB,MAAMd,EAAS,IACrBG,EAAG,EA5BhB,YA4BkBA,EAAEU,EAAOT,QA5B3B,wBA8BYU,EAAQD,EAAOV,GA9B3B,SA+B8BjB,EACjB3B,IAAI,IAAM8B,EAAOyB,EAAOvB,IACxB/B,MAAK,SAAAuD,GAAI,OAAIA,EAAKjD,KAAKkD,cAAc1C,UAjClD,cAmCkB2C,SAAQ,SAAAjC,GAEhBA,EAAEkB,KAAOD,EACTM,aAAaW,QAAQlC,EAAEqB,OAAQI,KAAKU,UAAUnC,IAC9CV,EAAOK,KAAKK,MAvCtB,QA4BkCmB,IA5BlC,gDA2CW7B,GA3CX,6GChGM8C,E,iDAIJC,eAAiB,E,KACjBC,WAAa,E,KAKbC,aAAe,G,KACfC,SAAW,E,KACXC,UAAY,E,yDAKV,OAAOC,KAAKL,eAAiBK,KAAKC,SAASC,MAAQF,KAAKD,Y,gCAKxD,OAAwB,MAApBC,KAAKG,aAA0C,MAAnBH,KAAKJ,WAC5B,KACmB,IAAxBI,KAAKL,eACA,KAEFK,KAAKG,YAAcH,KAAKJ,a,qCAK/B,IAAIQ,EAAyB,MAAjBJ,KAAKC,SAAmB,KAAOD,KAAKC,SAASI,mBACrDC,EAAiC,MAAjBN,KAAKC,SAAmB,KAAOD,KAAKC,SAASM,2BACjE,OAAa,MAATH,GAAkC,MAAjBE,EACZ,KAEF,KAAUF,EAAQE,EAAiB,O,KAIxCE,E,qJAEyBC,G,uEAE3B3C,IAAEyB,QAAQkB,GAAW,SAACC,GAEhBA,EAASC,OAAOC,QAAQ,KAAO,EACjCF,EAASG,SAAW,MACbH,EAASC,OAAOG,SAAS,OAChCJ,EAASG,SAAW,MACbH,EAASC,OAAOG,SAAS,MAChCJ,EAASG,SAAW,MACbH,EAASC,OAAOG,SAAS,OAChCJ,EAASG,SAAW,MAEpBH,EAASG,SAAW,SAGfpC,EAAI,E,YAAGA,EAAEgC,EAAU/B,Q,oBAEI,QAA1B+B,EAAUhC,GAAGoC,S,gCACgBtF,EAAQkF,EAAUhC,GAAGoC,SAAU,O,OAA9DJ,EAAUhC,GAAGsB,U,cAHmBtB,I,yHAQ3BsC,EAAb,sIAIgB/C,GAJhB,oFAOcpB,EAAS,GAPvB,SASgBhB,IACHC,IAAImC,GACJlC,MAAK,SAAAC,GACF,IAAMiF,EAAYC,IAAOlF,EAAIK,KAAM,CAAC8E,SAAQ,IAE5CpD,IAAEyB,QAAQyB,GAAW,SAAC5E,GAExBA,EAAK+E,OAASC,KAAKC,IAAInE,WAAWd,EAAK+E,SACvC/E,EAAK8D,MAAQhD,WAAWd,EAAK8D,OAC7B9D,EAAKkF,WAAapE,WAAWd,EAAKkF,YAElC,IAAIC,EAAOzD,IAAET,KAAKT,GAAQ,SAACU,GAAD,OAAOA,EAAEqD,SAAWvE,EAAKiC,UAQjD,OAPU,MAARkD,KAEFA,EAAO,IAAI7B,GACNiB,OAASvE,EAAKiC,OACnBkD,EAAKC,KAAOpF,EAAKoF,KACjB5E,EAAOK,KAAKsE,IAELnF,EAAKqF,KAAKC,eAEf,IAAK,MACHH,EAAK5B,gBAAkBvD,EAAK+E,OAC5BI,EAAK3B,YAAexD,EAAK+E,OAAS/E,EAAK8D,MAAQ9D,EAAKkF,WACpDC,EAAK1B,aAAa5C,KAAKb,GACvB,MACF,IAAK,OAMH,IAHoB,WAAhBA,EAAKuC,QACPgD,QAAQC,IAAI,IAERxF,EAAK+E,OAAS,GACpB,CACE,IAAIU,EAAkB/D,IAAEgE,KAAKP,EAAK1B,cAC9BkC,EAAIX,KAAKY,IAAIH,EAAgBV,OAAQ/E,EAAK+E,QAC9CI,EAAK3B,YAAcmC,EAAIF,EAAgB3B,MAAQ2B,EAAgBP,WAC/DC,EAAK5B,gBAAkBoC,EACvBF,EAAgBV,QAAUY,EAC1B3F,EAAK+E,QAAUY,EACfR,EAAKzB,UAAYiC,GAAK3F,EAAK8D,MAAQ2B,EAAgB3B,OAEpB,IAA3B2B,EAAgBV,QAClBI,EAAK1B,aAAaoC,MAEtB,MAEA,IAAK,eACHV,EAAKzB,UAAY1D,EAAKkF,kBAzD5C,uBAkEYd,EAAe0B,eAAetF,GAlE1C,cAoEYuF,EAAUvF,EAAOwF,KAAI,SAAA9E,GAAC,OAAGA,EAAEqD,UAE7B0B,EAAS,IAAIjE,EAtEvB,SAuE4BiE,EAAOC,KAAKH,EAAS,CAAChE,EAAuCA,IAvEzF,cAuEUoE,EAvEV,OAwEM3F,EAAO2C,SAAQ,SAAAjC,GAAC,OAAIA,EAAE2C,SAAWsC,EAAUlF,MAAK,SAAAmF,GAAC,OAAIA,EAAE7D,SAAWrB,EAAEqD,aAEpE/D,EAAO2C,SAAQ,SAAAmB,GAEc,MAArBA,EAAST,UAE+B,MAAxCS,EAAST,SAASI,qBAGtBK,EAASP,YAAcO,EAAST,SAASI,mBAAqBK,EAASf,eACvEe,EAAS+B,eAAiB/B,EAASX,UAAYW,EAASP,gBAlFlE,kBAoGqBvD,GApGrB,0GCyFe8F,E,YAlJX,WAAYC,GAAQ,IAAD,8BACf,4CAAMA,KAEDC,MAAQ,CAEXC,UAAY,GACZC,OAAQ,OACRC,cAAeC,IAAcC,KAG/B,EAAKC,MAAQ,EAAKA,MAAMC,KAAX,gBAVE,E,iFAoBI,IAAD,QAQK,IAAIpC,GAExBuB,KAAK,0FACLxG,MAAK,SAAA+G,GAAS,OAAI,EAAKO,SAAS,CAACP,UAAUA,S,oCAGlCQ,EAAMP,EAAQC,GAE1B,IAAIO,EAAcxF,IAAEgF,OAAOO,GAAM,SAAAE,GAE7B,GAAe,SAAXT,EACJ,CACE,IAAIU,EAAOD,EAAEE,eAOb,OANyB,IAArBF,EAAE5D,iBACJ6D,EAAO,MAEG,MAARA,GAAgBT,IAAkBC,IAAcU,OAClDF,GAAQ,KAEHA,EAGT,OAAOD,EAAET,MAKX,OAHEC,IAAkBC,IAAcU,OAClCJ,EAAcA,EAAYK,WAEnBL,I,+BAGqB,IAAzBR,EAAwB,EAAxBA,OAAQC,EAAgB,EAAhBA,cAETF,EACE7C,KAAK4C,MADPC,UAGES,EAActD,KAAK4D,cAAcf,EAAWC,EAAQC,GACxD/C,KAAKoD,SAAU,CAACP,UAAWS,EAAaR,OAAOA,EAAQC,cAAcA,M,qCAYxE,IARCc,EAQF,EAREA,SAGAC,GAKF,EAPEC,WAOF,EANEC,YAMF,EALEF,SAEAG,GAGF,EAJEC,YAIF,EAHED,SAIIE,GADN,EAFEC,SAGe,IAQb,GANc,gCAAZN,GAAiE,MAApBG,EAAQhE,UAEvC,MAAZ4D,IACFM,EAAWF,EAAQpD,UAGL,mBAAZiD,EACJ,OAAQ,6BAAkB,MAAZD,EAAmB,GAAIA,EAASQ,QAAQ,IAEtD,GAAgB,SAAZP,EACJ,CACE,IAAI1D,EAA4B,MAApB6D,EAAQhE,SAAmB,KAAOgE,EAAQhE,SAASI,mBAC3DC,EAAoC,MAApB2D,EAAQhE,SAAmB,KAAOgE,EAAQhE,SAASM,2BACvE,GAAa,MAATH,GAAkC,MAAjBE,EACnB,OAAO,8BAETuD,EAAY,KAAUzD,EAAQE,EAAiB,GAC/C6D,EAAW,IAOf,MAJkB,eAAZL,GAAwC,gBAAZA,GACb,IAAbD,IACFA,EAAW,MAET,6BAAkB,MAAZA,EAAmB,GAAIA,EAASQ,QAAQ,GAA9C,IAAmDF,K,+BAGrD,IAAD,SAMCnE,KAAK4C,MAFPE,GAJC,EAEDD,UAFC,EAIDC,QACAC,EALC,EAKDA,cAGJ,OACR,6BACE,6BACA,kBAAC,IAAD,MACG,cAAEuB,OAAF,IAAUC,EAAV,EAAUA,MAAV,OACD,kBAAC,IAAD,CACEA,MAAOA,EACPD,OAAQ,IACRE,aAAc,GACdC,UAAW,GACXC,KAAM,EAAKxB,MACXJ,OAAQA,EACRC,cAAeA,EACf4B,SAAU,EAAK/B,MAAMC,UAAUnE,OAC/BkG,UAAW,gBAAEC,EAAF,EAAEA,MAAF,OAAa,EAAKjC,MAAMC,UAAUgC,KAC3C,kBAAC,IAAD,CAAQC,MAAO,OAAQP,MAAO,IAAKQ,MAAM,OAAOjB,QAAQ,OAAOkB,aAAa,IAC5E,kBAAC,IAAD,CAAQT,MAAO,IAAKQ,MAAM,QAAQjB,QAAQ,8BAA8BkB,aAAa,EAAOC,eAAgB,gBAAEhB,EAAF,EAAEA,QAAF,OAAmC,MAApBA,EAAQhE,SAAmB,KAAOgE,EAAQhE,SAASI,oBAAoB6E,aAAc,EAAKC,cACrN,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,OAAOjB,QAAQ,OAAOkB,aAAa,EAAOC,eAAgB,qBAAEhB,QAAqBR,gBAAgByB,aAAc,EAAKC,cAC9I,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,SAASjB,QAAQ,iBAAiBkB,aAAa,EAAOE,aAAc,EAAKC,cACnG,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,cAAcjB,QAAQ,aAAakB,aAAa,EAAOE,aAAc,EAAKC,cACpG,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,eAAejB,QAAQ,cAAckB,aAAa,EAAOE,aAAc,EAAKC,cACtG,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,OAAOC,aAAa,EAAOC,eAAgB,qBAAEhB,QAAqBmB,WAAWF,aAAc,EAAKC,cAC1H,kBAAC,IAAD,CAAQZ,MAAO,IAAKQ,MAAM,YAAYjB,QAAQ,WAAWkB,aAAa,EAAOE,aAAc,EAAKC,kBApBtG,U,GArHyBE,aCcZC,MARf,WACE,OACE,yBAAKC,UAAU,OACb,kBAAC,EAAD,QCZcC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,SD6H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMrK,MAAK,SAAAsK,GACjCA,EAAaC,kB","file":"static/js/main.ec397c01.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.ee7cd8ed.svg\";","// import _ from 'lodash';\r\nimport axios from 'axios';\r\n\r\nclass Cache\r\n{\r\n    static Rates;\r\n}\r\n\r\nexport async function GetRate(from, to)\r\n{\r\n    if (Cache.Rates == null)\r\n    {\r\n        await axios\r\n            .get('https://cors-anywhere.herokuapp.com/https://www.ecb.europa.eu/stats/eurofxref/eurofxref-daily.xml')\r\n            .then(res => \r\n                {\r\n                    let parser=new DOMParser();\r\n                    let doc = parser.parseFromString(res.data, 'text/xml');\r\n                    \r\n                    let nsResolver = doc.createNSResolver(doc.documentElement);\r\n                    \r\n                    let nodes = doc.evaluate(\"/gesmes:Envelope/*[name()='Cube']/*[name()='Cube']/*[name()='Cube']\", doc.documentElement, nsResolver, XPathResult.ANY_TYPE, null);\r\n                    let result = [];\r\n                    let node;\r\n                    while((node = nodes.iterateNext()) != null) \r\n                    {\r\n                        let currency = node.getAttribute('currency');\r\n                        let rate = node.getAttribute('rate');\r\n\r\n                        result.push({ currency:currency, rate:parseFloat(rate)});\r\n\r\n                        if (currency === 'GBP')\r\n                        {\r\n                            result.push({ currency:'GBp', rate:1000.0 * parseFloat(rate)});\r\n\r\n                        }\r\n                    }\r\n\r\n                    result.push({ currency:'EUR', rate:1.0});\r\n\r\n                    Cache.Rates = result;\r\n                }); \r\n    }\r\n\r\n    if (Cache.Rates == null)\r\n        throw new Error('Failed to load the exchange rate file');\r\n\r\n    let fromRate = Cache.Rates.find(o =>o.currency === from);\r\n    if (fromRate == null)\r\n        throw new Error ('Failed to retrieve a rate for ' + from);\r\n    let toRate = Cache.Rates.find(o =>o.currency === to);\r\n    if (toRate == null)\r\n        throw new Error ('Failed to retrieve a rate for ' + toRate);\r\n\r\n    \r\n    let rate = (1/fromRate.rate) * toRate.rate;\r\n    return rate;\r\n} \r\n\r\n//export default GetRate;\r\n","import axios from 'axios';\r\nimport _ from 'lodash';\r\n\r\n\r\nconst anyCorsHttp = axios.create(\r\n    { baseURL:'https://cors-anywhere.herokuapp.com' }\r\n  );\r\n  \r\nconst yahooFinanceUrl = 'https://query1.finance.yahoo.com/v7/finance/quote';\r\n  \r\n  function getUrl(quotes, fields)\r\n  {\r\n    if (!_.isArray(quotes))\r\n      quotes = [quotes];\r\n  \r\n      let url = yahooFinanceUrl + '?symbols=' + _.join(quotes, ',');\r\n      if (fields == null)\r\n        return url;\r\n  \r\n      return url + \"&fields=\" + _.join(fields, ',');\r\n  }\r\n\r\nexport const YahooFinanceFields = {\r\n    /*\r\n    Ask : 'ask',\r\n    AskSize,\r\n    AverageDailyVolume10Day,\r\n    AverageDailyVolume3Month,\r\n    Bid,\r\n    BidSize,\r\n    BookValue,\r\n    */\r\n    Currency : 'currency',\r\n    /*\r\n    DividendDate,\r\n    EarningsTimestamp,\r\n    EarningsTimestampEnd,\r\n    EarningsTimestampStart,\r\n    EpsForward,\r\n    EpsTrailingTwelveMonths,\r\n    */\r\n    Exchange : 'exchange',\r\n    /*\r\n    ExchangeDataDelayedBy,\r\n    ExchangeTimezoneName,\r\n    ExchangeTimezoneShortName,\r\n    FiftyDayAverage,\r\n    FiftyDayAverageChange,\r\n    FiftyDayAverageChangePercent,\r\n    FiftyTwoWeekHigh,\r\n    FiftyTwoWeekHighChange,\r\n    FiftyTwoWeekHighChangePercent,\r\n    FiftyTwoWeekLow,\r\n    FiftyTwoWeekLowChange,\r\n    FiftyTwoWeekLowChangePercent,\r\n    FinancialCurrency,\r\n    ForwardPE,\r\n    FullExchangeName,\r\n    GmtOffSetMilliseconds,\r\n    Language,\r\n    LongName,\r\n    */\r\n    Market : 'market',\r\n    /*\r\n    MarketCap,\r\n    MarketState,\r\n    MessageBoardId,\r\n    PriceHint,\r\n    PriceToBook,\r\n    QuoteSourceName,\r\n    QuoteType,\r\n    RegularMarketChange,\r\n    RegularMarketChangePercent,\r\n    RegularMarketDayHigh,\r\n    RegularMarketDayLow,\r\n    */\r\n    RegularMarketOpen : 'regularMarketOpen',\r\n    RegularMarketPreviousClose : 'regularMarketPreviousClose',\r\n    RegularMarketPrice : 'regularMarketPrice',\r\n    /*\r\n    RegularMarketTime,\r\n    RegularMarketVolume,\r\n    PostMarketChange,\r\n    PostMarketChangePercent,\r\n    PostMarketPrice,\r\n    PostMarketTime,\r\n    SharesOutstanding,\r\n    ShortName,\r\n    SourceInterval,\r\n    */\r\n    Symbol,\r\n    /*\r\n    Tradeable,\r\n    TrailingAnnualDividendRate,\r\n    TrailingAnnualDividendYield,\r\n    TrailingPE,\r\n    TwoHundredDayAverage,\r\n    TwoHundredDayAverageChange,\r\n    TwoHundredDayAverageChangePercent\r\n    */\r\n  };\r\n\r\nexport class YahooFinanceLoader\r\n{ \r\n  async Load(symbols, fields)\r\n  {\r\n    let now = Date.now();\r\n    \r\n    let result = [];\r\n\r\n    for(let i = symbols.length - 1; i >= 0; i--)\r\n    {\r\n      let symbol = symbols[i];\r\n      let cacheItem = localStorage.getItem(symbol);\r\n      if (cacheItem != null)\r\n      {\r\n        cacheItem = JSON.parse(cacheItem);\r\n        if ((now - cacheItem.Date) < 1000 * 60 * 5) // 5 minutes\r\n        {\r\n          result.push(cacheItem);\r\n          symbols.splice(i, 1);\r\n        }\r\n        else\r\n        {\r\n          localStorage.removeItem(symbol);\r\n        }\r\n      }\r\n    }\r\n\r\n    let chunks = _.chunk(symbols, 50);\r\n    for (let i =0;i<chunks.length;i++)\r\n    {\r\n        let chunk = chunks[i];\r\n        let chunkData = await anyCorsHttp\r\n            .get('/' + getUrl(chunk, fields))\r\n            .then(json => json.data.quoteResponse.result);\r\n        \r\n        chunkData.forEach(o =>\r\n        {\r\n          o.Date = now;\r\n          localStorage.setItem(o.symbol, JSON.stringify(o));\r\n          result.push(o);\r\n        });\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n","import _ from 'lodash';\r\nimport parser  from 'csv-parse/lib/sync';\r\nimport axios from 'axios';\r\nimport { GetRate } from './ExchangeRates';\r\nimport{ YahooFinanceLoader, YahooFinanceFields } from './YahooFinanceLoader'\r\n\r\nclass SecurityPostion\r\n{\r\n  Ticker;\r\n  Market;\r\n  NumberOfShares = 0;\r\n  MarketCost = 0;\r\n  MarketPrice;\r\n  MarketPriceEUR;\r\n  Currency;\r\n  Name;\r\n  Transactions = [];\r\n  PastGain = 0;\r\n  RateToEUR = 1;\r\n  Security; // price of one share\r\n\r\n  PriceInEur()\r\n  {\r\n    return this.NumberOfShares * this.Security.Price * this.RateToEUR; \r\n  }\r\n\r\n  getGain()\r\n  {\r\n    if (this.MarketPrice == null || this.MarketCost == null)\r\n      return null;\r\n    if (this.NumberOfShares === 0)\r\n      return null;\r\n\r\n    return this.MarketPrice - this.MarketCost;\r\n  }\r\n\r\n  getPriceDiff()\r\n  {\r\n    let price = this.Security == null ? null : this.Security.regularMarketPrice;\r\n    let previousPrice = this.Security == null ? null : this.Security.regularMarketPreviousClose;\r\n    if (price == null || previousPrice == null)\r\n      return null;\r\n        \r\n    return 100.0 * ((price / previousPrice) - 1.0);\r\n  }\r\n}\r\n\r\nclass CurrencyHelper\r\n{\r\n  static async updateCurrency (positions)\r\n  {\r\n    _.forEach(positions, (position)=>\r\n    {\r\n      if (position.Ticker.indexOf('.') < 0)\r\n        position.Currency = \"USD\";\r\n      else if (position.Ticker.endsWith(\".SW\"))\r\n        position.Currency = \"CHF\";\r\n      else if (position.Ticker.endsWith(\".L\"))\r\n        position.Currency = \"GBp\";\r\n      else if (position.Ticker.endsWith(\".OL\"))\r\n        position.Currency = \"NOK\";\r\n      else \r\n        position.Currency = 'EUR';\r\n    });\r\n\r\n    for (let i = 0; i<positions.length; i++)\r\n    {\r\n      if (positions[i].Currency !== 'EUR')\r\n        positions[i].RateToEUR = await GetRate(positions[i].Currency, 'EUR');\r\n    }\r\n  }\r\n}\r\n\r\nexport class Portfolio\r\n{ \r\n    // Loads the specified transactions\r\n    // sample file: https://raw.githubusercontent.com/lionelschiepers/MyStock/master/MyStockWeb/Data/1.csv\r\n    async Load (url) \r\n     {\r\n        \r\n        const result = [];\r\n\r\n          await axios\r\n            .get(url)\r\n            .then(res => {\r\n                const parsedCsv = parser(res.data, {columns:true});\r\n\r\n                _.forEach(parsedCsv, (data)=>\r\n            {\r\n              data.Shares = Math.abs(parseFloat(data.Shares));\r\n              data.Price = parseFloat(data.Price);\r\n              data.Commission = parseFloat(data.Commission);\r\n              \r\n              let item = _.find(result, (o) => o.Ticker === data.Symbol);\r\n              if (item == null)\r\n              {\r\n                item = new SecurityPostion();\r\n                item.Ticker = data.Symbol;\r\n                item.Name = data.Name;\r\n                result.push(item);\r\n              }\r\n                switch(data.Type.toLowerCase())\r\n                {\r\n                  case 'buy':\r\n                    item.NumberOfShares += data.Shares;\r\n                    item.MarketCost +=  data.Shares * data.Price + data.Commission;\r\n                    item.Transactions.push(data);\r\n                    break;\r\n                  case 'sell':\r\n                    // calculate the past gain with the last transactions.\r\n\r\n                    if (data.symbol === 'PUM.DE')\r\n                      console.log('');\r\n\r\n                    while(data.Shares > 0)\r\n                    {\r\n                      let lastTransaction = _.last(item.Transactions);\r\n                      let x = Math.min(lastTransaction.Shares, data.Shares);\r\n                      item.MarketCost -= x * lastTransaction.Price + lastTransaction.Commission;\r\n                      item.NumberOfShares -= x;\r\n                      lastTransaction.Shares -= x;\r\n                      data.Shares -= x;\r\n                      item.PastGain += x * (data.Price - lastTransaction.Price);\r\n\r\n                      if (lastTransaction.Shares === 0)\r\n                        item.Transactions.pop();\r\n                    }\r\n                    break;\r\n\r\n                    case 'deposit cash':\r\n                      item.PastGain += data.Commission;\r\n                      break;\r\n                    default:\r\n                      break;\r\n                      \r\n                }\r\n              });\r\n      });\r\n\r\n      await CurrencyHelper.updateCurrency(result);\r\n\r\n      const tickers = result.map(o=> o.Ticker);\r\n\r\n      let loader = new YahooFinanceLoader();\r\n      let yahooData = await loader.Load(tickers, [YahooFinanceFields.RegularMarketPrice, YahooFinanceFields.RegularMarketPreviousClose]);\r\n      result.forEach(o => o.Security = yahooData.find(y => y.symbol === o.Ticker));\r\n\r\n      result.forEach(position =>\r\n        {\r\n          if (position.Security == null)\r\n            return;\r\n          if (position.Security.regularMarketPrice == null)\r\n            return;\r\n\r\n          position.MarketPrice = position.Security.regularMarketPrice * position.NumberOfShares;\r\n          position.MarketPriceEUR = position.RateToEUR * position.MarketPrice\r\n        });\r\n\r\n        /*\r\n        let totalMarketPrice = 0;\r\n        result\r\n        .filter(o=>o.MarketPriceEUR != null)\r\n        .forEach(o => \r\n          {\r\n            totalMarketPrice += o.MarketPriceEUR\r\n          });\r\n\r\n              let totalMarketCost = 0;\r\n              let eurPositions = _.filter(result, (o) => o.Currency === \"EUR\");\r\n\r\n              _.forEach(eurPositions, (o) => totalMarketCost+=o.MarketCost + o.PastGain);\r\n              // let totalCurrentPrice = 0;\r\n*/\r\n              return result;\r\n      \r\n    }\r\n}","import React, {Component} from 'react';\r\nimport {Column, Table, SortDirection, AutoSizer} from 'react-virtualized';\r\nimport 'react-virtualized/styles.css'; // only needs to be imported once\r\nimport _ from 'lodash';\r\n// import {YahooFinanceLoader, YahooFinanceFields} from './YahooFinanceLoader';\r\nimport { Portfolio } from './Portfolio';\r\n\r\n/*\r\nconst list = [\r\n  {name: 'Xavier', description: 'T'},\r\n  {name: 'Lionel', description: 'B'},\r\n  {name: 'Fabrice', description: 'E'},\r\n];\r\n*/\r\n\r\nclass YahooFinance extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n          // yahooData : {},\r\n          portfolio : [], //this._internalSort(list, 'name', SortDirection.ASC),\r\n          sortBy: 'Name',\r\n          sortDirection: SortDirection.ASC,\r\n        }\r\n\r\n        this._sort = this._sort.bind(this); \r\n        // this.renderPrice = this.renderPrice.bind(this);\r\n\r\n        // let loader = new YahooFinanceLoader();\r\n        // loader.Load(['AAPL', 'MSFT'], [YahooFinanceFields.RegularMarketPrice]);\r\n\r\n        // let portfolio = new Portfolio();\r\n        // portfolio.Load('https://raw.githubusercontent.com/lionelschiepers/MyStock/master/MyStockWeb/Data/1.csv');\r\n      }\r\n\r\n      componentDidMount() {\r\n        /*\r\n        let loader = new YahooFinanceLoader();\r\n        loader\r\n          .Load(['AAPL'], [YahooFinanceFields.RegularMarketPrice])\r\n          .then(result => \r\n            this.setState({yahooData : result}));\r\n*/\r\n        let portfolioBuilder = new Portfolio();\r\n        portfolioBuilder\r\n          .Load('https://raw.githubusercontent.com/lionelschiepers/MyStock/master/MyStockWeb/Data/1.csv')\r\n          .then(portfolio => this.setState({portfolio:portfolio}) );\r\n      }\r\n\r\n      _internalSort(list, sortBy, sortDirection)\r\n      {\r\n        let orderedList = _.sortBy(list, p => \r\n          {\r\n            if (sortBy === 'Diff')\r\n            {\r\n              let diff = p.getPriceDiff();\r\n              if (p.NumberOfShares === 0)\r\n                diff = null;\r\n                \r\n              if (diff == null && sortDirection === SortDirection.DESC)\r\n                diff = -100000000; // always at the bottom\r\n\r\n              return diff;\r\n            }\r\n\r\n            return p[sortBy]\r\n          });\r\n        if (sortDirection === SortDirection.DESC)\r\n          orderedList = orderedList.reverse();\r\n\r\n          return orderedList;\r\n      }\r\n\r\n      _sort({sortBy, sortDirection}) {\r\n        const {\r\n            portfolio\r\n          } = this.state;\r\n\r\n          let orderedList = this._internalSort(portfolio, sortBy, sortDirection);\r\n          this.setState( {portfolio: orderedList, sortBy:sortBy, sortDirection:sortDirection} );\r\n      }\r\n\r\n      renderPrice({\r\n        cellData,\r\n        columnData,\r\n        columnIndex,\r\n        dataKey,\r\n        isScrolling,\r\n        rowData,\r\n        rowIndex\r\n      })\r\n      {\r\n        let postData = '';\r\n        \r\n        if (dataKey === 'Security.regularMarketPrice' && rowData.Security != null)\r\n        {\r\n          if (cellData != null)\r\n            postData = rowData.Currency;\r\n        }\r\n        \r\n          if (dataKey === 'NumberOfShares')\r\n          return (<div>{cellData == null ? '': cellData.toFixed(0)}</div>);\r\n\r\n          if (dataKey === 'Diff')\r\n          {\r\n            let price = rowData.Security == null ? null : rowData.Security.regularMarketPrice;\r\n            let previousPrice = rowData.Security == null ? null : rowData.Security.regularMarketPreviousClose;\r\n            if (price == null || previousPrice == null)\r\n              return(<div />);\r\n            \r\n            cellData =  100.0 * ((price / previousPrice) - 1.0);\r\n            postData = '%';\r\n          }\r\n\r\n          if (dataKey === 'MarketCost' || dataKey === 'MarketPrice')\r\n            if (cellData === 0)\r\n              cellData = null;\r\n\r\n        return (<div>{cellData == null ? '': cellData.toFixed(2)} {postData}</div>);\r\n      }\r\n    \r\n    render() {\r\n        const {\r\n            portfolio,\r\n            // yahooData,\r\n            sortBy,\r\n            sortDirection,\r\n          } = this.state;\r\n\r\n        return (\r\n<div>\r\n  <div>\r\n  <AutoSizer>\r\n    {({height, width}) => (\r\n    <Table\r\n      width={width}\r\n      height={1000}\r\n      headerHeight={20}\r\n      rowHeight={30}\r\n      sort={this._sort}\r\n      sortBy={sortBy}\r\n      sortDirection={sortDirection}\r\n      rowCount={this.state.portfolio.length}\r\n      rowGetter={({index}) => this.state.portfolio[index]}>\r\n        <Column align={'left'} width={300} label=\"Name\" dataKey=\"Name\" disableSort={false} />\r\n        <Column width={100} label=\"Price\" dataKey=\"Security.regularMarketPrice\" disableSort={false} cellDataGetter={({rowData}) => rowData.Security == null ? null : rowData.Security.regularMarketPrice} cellRenderer={this.renderPrice} />\r\n        <Column width={100} label=\"Diff\" dataKey=\"Diff\" disableSort={false} cellDataGetter={({rowData}) => rowData.getPriceDiff()} cellRenderer={this.renderPrice} />\r\n        <Column width={100} label=\"Shares\" dataKey=\"NumberOfShares\" disableSort={false} cellRenderer={this.renderPrice} />\r\n        <Column width={150} label=\"Market Cost\" dataKey=\"MarketCost\" disableSort={false} cellRenderer={this.renderPrice} />\r\n        <Column width={150} label=\"Market Price\" dataKey=\"MarketPrice\" disableSort={false} cellRenderer={this.renderPrice} />\r\n        <Column width={150} label=\"Gain\" disableSort={false} cellDataGetter={({rowData}) => rowData.getGain()} cellRenderer={this.renderPrice} />\r\n        <Column width={150} label=\"Past Gain\" dataKey=\"PastGain\" disableSort={false} cellRenderer={this.renderPrice} />\r\n    </Table>\r\n    )}\r\n    </AutoSizer>,\r\n  </div>\r\n</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default YahooFinance;","import React from 'react';\r\nimport logo from './logo.svg';\r\nimport './App.css';\r\nimport YahooFinance from \"./Components/YahooFinance\";\r\n/*\r\n<header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.js</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n*/\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <YahooFinance />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}