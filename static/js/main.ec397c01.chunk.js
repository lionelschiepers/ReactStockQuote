(this["webpackJsonpmy-stock-quote"]=this["webpackJsonpmy-stock-quote"]||[]).push([[0],{122:function(e,t,r){e.exports=r(242)},127:function(e,t,r){},128:function(e,t,r){e.exports=r.p+"static/media/logo.ee7cd8ed.svg"},129:function(e,t,r){},213:function(e,t){},215:function(e,t){},242:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(24),c=r.n(i),o=(r(127),r(128),r(129),r(17)),u=r(25),l=r(120),s=r(114),f=r(52),h=r(121),d=r(11),m=(r(190),r(13)),b=r.n(m),y=r(15),p=r.n(y),k=r(30),S=r(119),v=r.n(S),w=r(37),P=r.n(w),g=function e(){Object(o.a)(this,e)};function E(e,t){return C.apply(this,arguments)}function C(){return(C=Object(k.a)(p.a.mark((function e(t,r){var a,n,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=g.Rates){e.next=3;break}return e.next=3,P.a.get("https://cors-anywhere.herokuapp.com/https://www.ecb.europa.eu/stats/eurofxref/eurofxref-daily.xml").then((function(e){for(var t,r=(new DOMParser).parseFromString(e.data,"text/xml"),a=r.createNSResolver(r.documentElement),n=r.evaluate("/gesmes:Envelope/*[name()='Cube']/*[name()='Cube']/*[name()='Cube']",r.documentElement,a,XPathResult.ANY_TYPE,null),i=[];null!=(t=n.iterateNext());){var c=t.getAttribute("currency"),o=t.getAttribute("rate");i.push({currency:c,rate:parseFloat(o)}),"GBP"===c&&i.push({currency:"GBp",rate:1e3*parseFloat(o)})}i.push({currency:"EUR",rate:1}),g.Rates=i}));case 3:if(null!=g.Rates){e.next=5;break}throw new Error("Failed to load the exchange rate file");case 5:if(null!=(a=g.Rates.find((function(e){return e.currency===t})))){e.next=8;break}throw new Error("Failed to retrieve a rate for "+t);case 8:if(null!=(n=g.Rates.find((function(e){return e.currency===r})))){e.next=11;break}throw new Error("Failed to retrieve a rate for "+n);case 11:return i=1/a.rate*n.rate,e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=P.a.create({baseURL:"https://cors-anywhere.herokuapp.com"});function M(e,t){b.a.isArray(e)||(e=[e]);var r="https://query1.finance.yahoo.com/v7/finance/quote?symbols="+b.a.join(e,",");return null==t?r:r+"&fields="+b.a.join(t,",")}var O="regularMarketPreviousClose",D="regularMarketPrice",R=(Symbol,function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,[{key:"Load",value:function(){var e=Object(k.a)(p.a.mark((function e(t,r){var a,n,i,c,o,u,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=Date.now(),n=[],i=t.length-1;i>=0;i--)c=t[i],null!=(o=localStorage.getItem(c))&&(o=JSON.parse(o),a-o.Date<3e5?(n.push(o),t.splice(i,1)):localStorage.removeItem(c));u=b.a.chunk(t,50),l=0;case 5:if(!(l<u.length)){e.next=14;break}return s=u[l],e.next=9,x.get("/"+M(s,r)).then((function(e){return e.data.quoteResponse.result}));case 9:e.sent.forEach((function(e){e.Date=a,localStorage.setItem(e.symbol,JSON.stringify(e)),n.push(e)}));case 11:l++,e.next=5;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}()),j=function(){function e(){Object(o.a)(this,e),this.NumberOfShares=0,this.MarketCost=0,this.Transactions=[],this.PastGain=0,this.RateToEUR=1}return Object(u.a)(e,[{key:"PriceInEur",value:function(){return this.NumberOfShares*this.Security.Price*this.RateToEUR}},{key:"getGain",value:function(){return null==this.MarketPrice||null==this.MarketCost?null:0===this.NumberOfShares?null:this.MarketPrice-this.MarketCost}},{key:"getPriceDiff",value:function(){var e=null==this.Security?null:this.Security.regularMarketPrice,t=null==this.Security?null:this.Security.regularMarketPreviousClose;return null==e||null==t?null:100*(e/t-1)}}]),e}(),N=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,null,[{key:"updateCurrency",value:function(){var e=Object(k.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.a.forEach(t,(function(e){e.Ticker.indexOf(".")<0?e.Currency="USD":e.Ticker.endsWith(".SW")?e.Currency="CHF":e.Ticker.endsWith(".L")?e.Currency="GBp":e.Ticker.endsWith(".OL")?e.Currency="NOK":e.Currency="EUR"})),r=0;case 2:if(!(r<t.length)){e.next=10;break}if("EUR"===t[r].Currency){e.next=7;break}return e.next=6,E(t[r].Currency,"EUR");case 6:t[r].RateToEUR=e.sent;case 7:r++,e.next=2;break;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,[{key:"Load",value:function(){var e=Object(k.a)(p.a.mark((function e(t){var r,a,n,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,P.a.get(t).then((function(e){var t=v()(e.data,{columns:!0});b.a.forEach(t,(function(e){e.Shares=Math.abs(parseFloat(e.Shares)),e.Price=parseFloat(e.Price),e.Commission=parseFloat(e.Commission);var t=b.a.find(r,(function(t){return t.Ticker===e.Symbol}));switch(null==t&&((t=new j).Ticker=e.Symbol,t.Name=e.Name,r.push(t)),e.Type.toLowerCase()){case"buy":t.NumberOfShares+=e.Shares,t.MarketCost+=e.Shares*e.Price+e.Commission,t.Transactions.push(e);break;case"sell":for("PUM.DE"===e.symbol&&console.log("");e.Shares>0;){var a=b.a.last(t.Transactions),n=Math.min(a.Shares,e.Shares);t.MarketCost-=n*a.Price+a.Commission,t.NumberOfShares-=n,a.Shares-=n,e.Shares-=n,t.PastGain+=n*(e.Price-a.Price),0===a.Shares&&t.Transactions.pop()}break;case"deposit cash":t.PastGain+=e.Commission}}))}));case 3:return e.next=5,N.updateCurrency(r);case 5:return a=r.map((function(e){return e.Ticker})),n=new R,e.next=9,n.Load(a,[D,O]);case 9:return i=e.sent,r.forEach((function(e){return e.Security=i.find((function(t){return t.symbol===e.Ticker}))})),r.forEach((function(e){null!=e.Security&&null!=e.Security.regularMarketPrice&&(e.MarketPrice=e.Security.regularMarketPrice*e.NumberOfShares,e.MarketPriceEUR=e.RateToEUR*e.MarketPrice)})),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),G=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(l.a)(this,Object(s.a)(t).call(this,e))).state={portfolio:[],sortBy:"Name",sortDirection:d.c.ASC},r._sort=r._sort.bind(Object(f.a)(r)),r}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;(new T).Load("https://raw.githubusercontent.com/lionelschiepers/MyStock/master/MyStockWeb/Data/1.csv").then((function(t){return e.setState({portfolio:t})}))}},{key:"_internalSort",value:function(e,t,r){var a=b.a.sortBy(e,(function(e){if("Diff"===t){var a=e.getPriceDiff();return 0===e.NumberOfShares&&(a=null),null==a&&r===d.c.DESC&&(a=-1e8),a}return e[t]}));return r===d.c.DESC&&(a=a.reverse()),a}},{key:"_sort",value:function(e){var t=e.sortBy,r=e.sortDirection,a=this.state.portfolio,n=this._internalSort(a,t,r);this.setState({portfolio:n,sortBy:t,sortDirection:r})}},{key:"renderPrice",value:function(e){var t=e.cellData,r=(e.columnData,e.columnIndex,e.dataKey),a=(e.isScrolling,e.rowData),i=(e.rowIndex,"");if("Security.regularMarketPrice"===r&&null!=a.Security&&null!=t&&(i=a.Currency),"NumberOfShares"===r)return n.a.createElement("div",null,null==t?"":t.toFixed(0));if("Diff"===r){var c=null==a.Security?null:a.Security.regularMarketPrice,o=null==a.Security?null:a.Security.regularMarketPreviousClose;if(null==c||null==o)return n.a.createElement("div",null);t=100*(c/o-1),i="%"}return"MarketCost"!==r&&"MarketPrice"!==r||0===t&&(t=null),n.a.createElement("div",null,null==t?"":t.toFixed(2)," ",i)}},{key:"render",value:function(){var e=this,t=this.state,r=(t.portfolio,t.sortBy),a=t.sortDirection;return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(d.a,null,(function(t){t.height;var i=t.width;return n.a.createElement(d.d,{width:i,height:1e3,headerHeight:20,rowHeight:30,sort:e._sort,sortBy:r,sortDirection:a,rowCount:e.state.portfolio.length,rowGetter:function(t){var r=t.index;return e.state.portfolio[r]}},n.a.createElement(d.b,{align:"left",width:300,label:"Name",dataKey:"Name",disableSort:!1}),n.a.createElement(d.b,{width:100,label:"Price",dataKey:"Security.regularMarketPrice",disableSort:!1,cellDataGetter:function(e){var t=e.rowData;return null==t.Security?null:t.Security.regularMarketPrice},cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:100,label:"Diff",dataKey:"Diff",disableSort:!1,cellDataGetter:function(e){return e.rowData.getPriceDiff()},cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:100,label:"Shares",dataKey:"NumberOfShares",disableSort:!1,cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:150,label:"Market Cost",dataKey:"MarketCost",disableSort:!1,cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:150,label:"Market Price",dataKey:"MarketPrice",disableSort:!1,cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:150,label:"Gain",disableSort:!1,cellDataGetter:function(e){return e.rowData.getGain()},cellRenderer:e.renderPrice}),n.a.createElement(d.b,{width:150,label:"Past Gain",dataKey:"PastGain",disableSort:!1,cellRenderer:e.renderPrice}))})),","))}}]),t}(a.Component);var F=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(G,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[122,1,2]]]);
//# sourceMappingURL=main.ec397c01.chunk.js.map